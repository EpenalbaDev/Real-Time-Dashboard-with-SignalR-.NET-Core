sequenceDiagram
    participant TP as TransactionProcessor
    participant BATCH as Internal Batch (List+lock)
    participant CH as Channel&lt;T&gt; (10K)
    participant DB as MySQL
    participant MA as MetricsAggregator
    participant MC as IMemoryCache
    participant BC as DashboardBroadcaster
    participant HUB as SignalR Hub
    participant CL as Blazor Client

    Note over TP: Generates txns at configurable TPS (default: 10)

    loop Every ~100ms (at 10 TPS)
        TP->>BATCH: Add to internal List (lock)
        TP->>CH: WriteAsync(transaction)
        TP-->>TP: SimulateProcessingAsync (fire-and-forget)
    end

    loop Every 1 second
        BATCH->>DB: FlushBatchAsync → SaveChangesAsync
        Note over BATCH,DB: Batch INSERT (typically 10 rows)
    end

    loop Every 500ms (PeriodicTimer)
        MA->>DB: SELECT WHERE CreatedAt >= 1hr ago
        MA->>MA: Compute TPS, rates, volumes, top sources
        MA->>MC: Cache.Set(metrics, TTL: 5s)
    end

    loop Every 500ms (PeriodicTimer)
        BC->>CH: TryRead() → drain all to buffer

        alt Buffer has transactions
            BC->>HUB: ReceiveTransactionBatch(List&lt;TransactionDto&gt;)

            opt Flagged transactions exist
                BC->>HUB: ReceiveAlert(AlertDto)
            end
        end

        BC->>MC: GetCachedMetrics()

        alt Metrics available
            BC->>HUB: ReceiveMetricsUpdate(DashboardMetricsDto)
        end

        HUB->>CL: WebSocket frame (JSON)
    end

    Note over CL: Receives batch, updates all components
    CL->>CL: Update TransactionChart (line, 300-point window)
    CL->>CL: Update StatusChart (doughnut)
    CL->>CL: Update SourceChart (bar)
    CL->>CL: Prepend to TransactionTable (last 100)
    CL->>CL: Update MetricsCards
    CL->>CL: StateHasChanged()
