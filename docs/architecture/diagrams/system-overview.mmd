graph TB
    subgraph "Blazor Server Application"
        direction TB

        subgraph "Background Services"
            TP["TransactionProcessor<br/>Generates simulated txns<br/>Configurable TPS"]
            MA["MetricsAggregator<br/>Pre-computes metrics<br/>Every 500ms"]
            BC["DashboardBroadcaster<br/>Batched SignalR updates<br/>Every 500ms"]
        end

        CH_TXN["Channel&lt;TransactionEntity&gt;<br/>Bounded: 10K capacity<br/>FullMode: Wait"]
        CACHE["IMemoryCache<br/>Metrics Cache (TTL: 5s)"]
        HUB["SignalR Hub<br/>DashboardHub : Hub&lt;IDashboardClient&gt;"]
        DIAG["/api/diagnostics<br/>Performance endpoint"]

        subgraph "Blazor Components"
            DASH["Dashboard.razor<br/>HubConnection + auto-reconnect"]
            CHART["TransactionChart.razor<br/>Chart.js line chart"]
            TABLE["TransactionTable.razor<br/>Live feed (last 100)"]
            STATUS["StatusChart.razor<br/>Doughnut chart"]
            SOURCE["SourceChart.razor<br/>Bar chart"]
            CARDS["MetricsCard.razor"]
            INDICATOR["StatusIndicator.razor"]
        end
    end

    DB[(MySQL 8.0<br/>Transactions table<br/>Indexed: CreatedAt, Status, Type)]

    TP -->|"Produce"| CH_TXN
    TP -->|"Batch INSERT (every 1s)"| DB
    CH_TXN -->|"TryRead (drain)"| BC
    MA -->|"SELECT last 1hr"| DB
    MA -->|"Cache.Set()"| CACHE
    BC -->|"GetCachedMetrics()"| CACHE
    BC -->|"ReceiveTransactionBatch<br/>ReceiveMetricsUpdate<br/>ReceiveAlert"| HUB

    HUB -->|"WebSocket"| C1["Client 1"]
    HUB -->|"WebSocket"| C2["Client 2"]
    HUB -->|"WebSocket"| CN["Client N"]

    DASH --- CHART
    DASH --- TABLE
    DASH --- STATUS
    DASH --- SOURCE
    DASH --- CARDS
    DASH --- INDICATOR

    style TP fill:#4CAF50,color:#fff
    style MA fill:#2196F3,color:#fff
    style BC fill:#9C27B0,color:#fff
    style HUB fill:#F44336,color:#fff
    style DB fill:#607D8B,color:#fff
    style CH_TXN fill:#FFC107,color:#000
    style CACHE fill:#00BCD4,color:#fff
    style DIAG fill:#FF5722,color:#fff
